--------------Creating Customer View-------------------

CREATE VIEW gold.dim_customers AS
SELECT
ROW_NUMBER() OVER (ORDER BY cst_id) AS customer_key,
a.cst_id as customer_id,
a.cst_key as customer_number,
a.cst_firstname as first_name,
a.cst_lastname as last_name,
CASE WHEN a.cst_gndr != 'n/a' THEN cst_gndr
     ELSE COALESCE(b.gen, 'n/a') 
	 END as gender,
a.cst_marital_status as marital_status,
a.cst_create_date as create_date,
b.bdate as birthday,
c.cntry as country
from silver.crm_cust_info a
LEFT JOIN silver.erp_cust_az12 b
ON a.cst_key = b.cid
LEFT JOIN silver.erp_loc_a101 c
ON a.cst_key = c.cid
